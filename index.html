<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>URL Redirect Tool - Host-A</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}</style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-8">
  <div class="max-w-2xl mx-auto">
    <div class="bg-white rounded-2xl shadow-xl p-8">
      <div class="flex items-center gap-3 mb-8">
        <div class="bg-indigo-600 p-3 rounded-lg">
          <svg class="text-white" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
          </svg>
        </div>
        <div>
          <h1 class="text-3xl font-bold text-gray-900">URL Redirect Tool</h1>
          <p class="text-gray-600">Generates a Host-B link that tries new-tab open + auto-close</p>
        </div>
      </div>

      <div class="space-y-6">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Enter URL or PDF Link</label>
          <input id="longUrl" type="text" placeholder="https://example.com/file.pdf or https://example.com/page"
                 class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none" />
          <p id="error" class="mt-2 text-sm text-red-600 hidden"></p>
        </div>

        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
          <div class="flex items-start gap-2">
            <input type="checkbox" id="isPdf" class="mt-1" />
            <div class="flex-1">
              <label for="isPdf" class="font-medium text-blue-900 cursor-pointer">This is a PDF (auto download)</label>
              <p class="text-sm text-blue-700 mt-1">
                Host-B will attempt to start the download in a new tab and then close the original tab. If blocked, it will fall back to same-tab redirect.
              </p>
            </div>
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Your Host-B Redirect Base URL</label>
          <input id="hostB" type="text" placeholder="https://jazchemicals.com/rd/redirect.php"
                 class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none" />
          <p class="text-xs text-gray-500 mt-1">This is the PHP endpoint youâ€™ll upload on Host-B.</p>
        </div>

        <button onclick="generate()" class="w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 shadow-md">
          Generate Redirect Link
        </button>

        <div id="result" class="hidden bg-green-50 border border-green-200 rounded-lg p-6 space-y-4">
          <div>
            <label class="block text-sm font-medium text-green-900 mb-2">Your New Link (Host-B)</label>
            <div class="flex gap-2">
              <input id="shortUrl" type="text" readonly
                     class="flex-1 px-4 py-3 bg-white border border-green-300 rounded-lg font-mono text-sm" />
              <button onclick="copyUrl()" class="px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700" title="Copy">
                <span id="copyIcon">ðŸ“‹</span>
              </button>
            </div>
          </div>

          <div class="text-sm text-green-800 bg-green-100 p-3 rounded">
            <strong>Note:</strong> Direct address-bar opens can still be blocked in some browsers. Our Host-B page tries several methods and falls back gracefully.
          </div>
        </div>
      </div>
    </div>

    <div class="mt-6 text-center text-sm text-gray-600">
      <p>âœ¨ Best-effort new-tab open + auto-close. Pop-up blockers may still intervene in some cases.</p>
    </div>
  </div>

  <script>
    function isValidUrl(s){ try{ new URL(s); return true } catch{ return false } }
    function b64u(str){ return btoa(unescape(encodeURIComponent(str))).replace(/\+/g,'-').replace(/\//g,'_').replace(/=+$/,'') }

    function generate(){
      const hostB = document.getElementById('hostB').value.trim();
      const longUrl = document.getElementById('longUrl').value.trim();
      const isPdf  = document.getElementById('isPdf').checked;
      const errEl  = document.getElementById('error');
      errEl.classList.add('hidden');

      if(!hostB || !/^https?:\/\//i.test(hostB)){
        errEl.textContent = 'Enter a valid Host-B redirect.php URL (including https://)';
        errEl.classList.remove('hidden'); return;
      }
      if(!longUrl || !isValidUrl(longUrl)){
        errEl.textContent = 'Enter a valid destination URL (including https://)';
        errEl.classList.remove('hidden'); return;
      }

      const u = b64u(longUrl);
      const link = `${hostB}?u=${u}&pdf=${isPdf?1:0}`;

      document.getElementById('shortUrl').value = link;
      document.getElementById('result').classList.remove('hidden');
    }

    function copyUrl(){
      const el = document.getElementById('shortUrl');
      el.select(); document.execCommand('copy');
      const ico = document.getElementById('copyIcon');
      ico.textContent = 'âœ“'; setTimeout(()=>ico.textContent='ðŸ“‹', 1200);
    }
  </script>
</body>
</html>
